    TIP: 0005
    Title: TIP-5 Single Token Registry Standard
    Authors: Stephen Craig Branscom
    Status: Draft
    Type: Protocol
    Created: 2018-08-01

# Abstract

This proposal outlines a plan to standardize Token Registries across the Telos Network, as well as define a common interface for use by third parties.

# Motivation

As the Telos Network grows, standardized communication interfaces will become necessary in order to allow complex token transactions. Declaring a network-wide standard will allow any tokens developed on Telos to be reused by other applications.

# Rationale

In the Telos Network, a token or groups of tokens are collectively tracked and managed by a single contract, which will henceforth be known as a Token Registry. Due to the free nature of the network, anyone can write their own Token Registry, which will likely result in a multitude of different interfaces across the network.

# Specification

The TIP-5 Single Token Registry Standard defines an interface that allows third-party support for token contracts that implement a single token. The interface is defined as follows:

### Tables

* `typedef multi_index< N(balances), balance> balances_table`

    The `balances` table will hold all accounts and their respective token balances. The table is indexed by account_name.

* `typedef multi_index< N(allotments), allotment> allotments_table`

    The `allotments` table will hold all approved account allotments, indexed by the token owner's account_name.

* `typedef eosio::singleton<N(singleton), setting> settings_table`

    The `settings` singleton holds all token related information such as max_supply and name.

### Structs

* `setting`

    `accuont_name issuer` refers to the account authorized to mint new tokens.

    `asset max_supply` holds the maximum supply of tokens to be allowed in circulation.

    `asset supply` stores the total tokens currently in circulation.

    `string name` holds the human-readable name of the token.

    `bool is_initialized` represents whether the token has been initialized.

* `balance`

    `account_name owner` refers to the account that owns the tokens.

    `asset tokens` holds the balance of tokens owned by the owner.

* `allotment`

    `account_name recipient` refers to the account that has the authority to withdraw from the tokens field.

    `account_name owner` refers to the account that owns the tokens that have been allotted.
    
    `asset tokens` holds the allotment to be withdrawn by `recipient`.

### ABI Actions

* `void mint(account_name recipient, asset tokens)`

    Mints new tokens into the circulating supply.

* `void transfer(account_name owner, account_name recipient, asset tokens)`

    Transfers tokens from the owner account to the recipient account.

* `void allot(account_name owner, account_name recipient, asset tokens)`

    Allows recipient to withdraw from the owner account, multiple times, up to the value of tokens. Subsequent allotments called by the same owner to the same recipient are added together.

* `void reclaim(account_name owner, account_name recipient, asset tokens)`

    Reclaims an allotment of tokens back into the owner's balance.

* `void transferfrom(account_name owner, account_name recipient, asset tokens)`

    Transfers tokens from the owner allotment to the recipient account, up to the amount defined by the owner's call to the allot() action.

* `void createwallet(account_name owner)`

    Creates a zero balance entry in the balances table for the calling account. Users should call this action first to create a balance entry for holding their future tokens. This will consume a small amount of RAM, which will be reclaimed should the user ever choose to delete their balance entry.

* `void deletewallet(account_name owner)`

    Deletes an entry in the balances table for the calling account. Ensure the entry has a balance of zero, otherwise tokens will be deleted.

### Functions

* `void sub_balance(account_name owner, asset tokens)`

    Subtracts tokens from owner's balance.

* `void add_balance(account_name owner, asset tokens, account_name payer)`

    Adds tokens to owner's balance. Charges payer with resource consumption.

* `void sub_allot(account_name owner, account_name recipient, asset tokens)`

    Subtracts tokens from owner's allotment to recipient.

* `void add_allot(account_name owner, account_name recipient, asset tokens, account_name payer)`

    Adds tokens to owner's allotment to recipient. Charges payer with resource consumption.

As stated in TIP-3 Option A, the eosio.token contract will be modified to serve as a Master Registry that maintains a running table of all other Token Registries. By calling `registertoken()` on the Master Registry contract, the calling account registers an independently written Single Token Registry. Registering an independent contract in this way will add the contract information to a table managed by the Master Registry.

# Discussion

* Does this interface only work for single token contracts?

    Answer: Yes. A forthcoming Multi Token Registry Standard will declare an interface for interacting with contracts that implement 1 or more tokens on a single contract.

# Summary for Shareholders

The changes suggested in this TIP will declare a standard for developing token contracts. This will pave the way for contract integration with exchanges and other third-party developers.

# Copyright

This document is placed in the public domain.